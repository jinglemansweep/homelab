steps:
  mail:
    image: deblan/woodpecker-email
    settings:
      dsn: ${SMTP_DSN}
      from:
        address: ${SMTP_FROM}
        name: "CI"
      evaluate: 'commit.branch == "main"'
      recipients:
        - ${EMAIL_NOTIFICATIONS}
      level: success
      recipients_only: false
      content:
        subject: "[{{ pipeline.status }}] {{ repo.full_name }} ({{ commit.branch }} - {{ commit.sha[0:8] }})"
        body: |
          {{ commit.sha }}<br>
          {{ pipeline.status }}<br>
          {{ commit.author_email }}<br>
      attachments:
        - log/*